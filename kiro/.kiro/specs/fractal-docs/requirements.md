# 需求文档

## 介绍

Fractal Docs 是一套基于 Kiro Steering 机制的文档维护规范，通过自动加载的规则文件和文件引用语法，实现分形结构的文档管理。系统通过标准化的文档模板和自指更新提醒，实现文档的自动维护。

设计灵感来自《哥德尔、埃舍尔、巴赫》中的自指和递归概念。

## 术语表

- **Steering**: Kiro 的规则加载机制，通过 `.kiro/steering/*.md` 文件自动注入上下文
- **文件引用**: Kiro 的 `#[[file:path]]` 语法，自动拉取指定文件内容到上下文
- **分形结构**: 每个层级都遵循相同文档模式的递归结构
- **自指提醒**: 文档中包含的更新提醒文本，触发 AI 自动维护相关文档
- **三行注释**: 每个文件开头的 input/output/pos 标准注释格式
- **inclusion 模式**: Steering 文件的加载方式（always/fileMatch/manual）

## 需求

### 需求 1: Kiro Steering 规则配置

**用户故事:** 作为开发者，我希望通过 Kiro Steering 机制自动加载文档维护规则。

#### 验收标准

1. Steering 系统自动加载 `.kiro/steering/` 目录下的规则文件
2. 规则文件设置 `inclusion: always` 时，每次交互都加载
3. 规则文件使用 `#[[file:path]]` 语法时，自动拉取引用文件的内容
4. AI 修改代码文件时，Steering 规则提醒执行文档维护步骤

### 需求 2: 文档模板标准化

**用户故事:** 作为开发者，我希望有标准化的文档模板。

#### 验收标准

1. 文件夹 README.md 使用标准的架构说明 + 文件索引格式
2. 文件头部注释使用标准的 input/output/pos 格式
3. 更新提醒使用标准的自指提醒文本
4. 不同文件类型使用对应语言的注释格式

### 需求 3: 项目结构导航

**用户故事:** 作为开发者，我希望 AI 能快速了解项目结构。

#### 验收标准

1. Steering 系统通过文件引用自动加载核心目录的 README.md
2. 目录索引提供文件名和功能描述的对应关系
3. 新建文件时，目录索引提供命名规范参考

### 需求 4: 分形结构自维护

**用户故事:** 作为开发者，我希望文档系统能够通过自指机制实现自我维护。

#### 验收标准

1. 文档包含更新相关文档的自指提醒
2. 文件夹结构变化时，AI 自动更新当前目录和上级目录的 README.md
3. 新增文件时，AI 自动更新所属文件夹的文件索引
4. 修改代码文件时，AI 自动更新文件头部的注释

### 需求 5: 增量更新保护

**用户故事:** 作为开发者，我希望 AI 在更新文档时先读取现有内容再增量更新。

#### 验收标准

1. AI 更新 README.md 时先检查文件是否存在
2. README.md 已存在时先读取再增量更新
3. README.md 不存在时使用模板创建
4. 更新文件头部注释时保留现有注释并更新

### 需求 6: 文档维护报告

**用户故事:** 作为开发者，我希望 AI 完成代码修改后输出文档维护报告。

#### 验收标准

1. AI 完成代码修改时输出标准格式的文档维护报告
2. 报告包含修改的文件列表和状态
3. 报告包含 README.md 更新状态
4. 报告包含上级目录检查结果
